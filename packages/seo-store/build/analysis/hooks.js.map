{"version":3,"sources":["../../src/analysis/hooks.js"],"names":["useDispatch","useSelect","useCallback","debounce","STORE_NAME","useEffectWithDeepCompare","ANALYZE_DEBOUNCE_TIME_IN_MS","useAnalyze","debounceTimeInMs","analyze","paper","select","selectPaper","keyphrases","selectKeyphraseEntries","config","selectAnalysisConfig","editor","selectEditor","debouncedAnalyze"],"mappings":"AAAA,SAASA,WAAT,EAAsBC,SAAtB,QAAuC,iBAAvC;AACA,SAASC,WAAT,QAA4B,oBAA5B;AACA,SAASC,QAAT,QAAyB,QAAzB;AACA,SAASC,UAAT,QAA2B,qBAA3B;AACA,SAASC,wBAAT,QAAyC,iBAAzC;AACA,SAASC,2BAAT,QAA4C,aAA5C;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,UAAU,GAAG,YAAsD;AAAA,MAApDC,gBAAoD,uEAAjCF,2BAAiC;AAC/E,QAAM;AAAEG,IAAAA;AAAF,MAAcT,WAAW,CAAEI,UAAF,CAA/B;AACA,QAAMM,KAAK,GAAGT,SAAS,CAAEU,MAAM,IAAIA,MAAM,CAAEP,UAAF,CAAN,CAAqBQ,WAArB,EAAZ,CAAvB;AACA,QAAMC,UAAU,GAAGZ,SAAS,CAAEU,MAAM,IAAIA,MAAM,CAAEP,UAAF,CAAN,CAAqBU,sBAArB,EAAZ,CAA5B;AACA,QAAMC,MAAM,GAAGd,SAAS,CAAEU,MAAM,IAAIA,MAAM,CAAEP,UAAF,CAAN,CAAqBY,oBAArB,EAAZ,CAAxB;AACA,QAAMC,MAAM,GAAGhB,SAAS,CAAEU,MAAM,IAAIA,MAAM,CAAEP,UAAF,CAAN,CAAqBc,YAArB,EAAZ,CAAxB;AACA,QAAMC,gBAAgB,GAAGjB,WAAW,CACnCC,QAAQ,CAAEM,OAAF,EAAWD,gBAAX,CAD2B,EAEnC,CAAEC,OAAF,EAAWD,gBAAX,CAFmC,CAApC;AAKAH,EAAAA,wBAAwB,CAAE,MAAM;AAC/Bc,IAAAA,gBAAgB;AAChB,GAFuB,EAErB,CAAEA,gBAAF,EAAoBT,KAApB,EAA2BG,UAA3B,EAAuCE,MAAvC,EAA+CE,MAA/C,CAFqB,CAAxB;AAGA,CAdM","sourcesContent":["import { useDispatch, useSelect } from \"@wordpress/data\";\nimport { useCallback } from \"@wordpress/element\";\nimport { debounce } from \"lodash\";\nimport { STORE_NAME } from \"../common/constants\";\nimport { useEffectWithDeepCompare } from \"../common/hooks\";\nimport { ANALYZE_DEBOUNCE_TIME_IN_MS } from \"./constants\";\n\n/**\n * Analyzes whenever data changes.\n *\n * Which data is being watched?\n * - Paper data\n * - Keyphrases and synonyms\n * - Analysis on-the-fly configuration\n * - Editor data: as this is the common source of replacevars\n *\n * A choice has been made here to not apply the replacevars in the paper data yet.\n * Instead, the editor data is being watched. This should be expanded to all relevant state being kept in this store.\n * When implementers add replacevars with sources outside of this store, they are responsible for calling analyze for themselves.\n * The positive here is that this does not rely on outside data calls (which the replacevars can be/are).\n *\n * @param {number} debounceTimeInMs Amount of millisecond to debounce for.\n *\n * @returns {void}\n */\nexport const useAnalyze = ( debounceTimeInMs = ANALYZE_DEBOUNCE_TIME_IN_MS ) => {\n\tconst { analyze } = useDispatch( STORE_NAME );\n\tconst paper = useSelect( select => select( STORE_NAME ).selectPaper() );\n\tconst keyphrases = useSelect( select => select( STORE_NAME ).selectKeyphraseEntries() );\n\tconst config = useSelect( select => select( STORE_NAME ).selectAnalysisConfig() );\n\tconst editor = useSelect( select => select( STORE_NAME ).selectEditor() );\n\tconst debouncedAnalyze = useCallback(\n\t\tdebounce( analyze, debounceTimeInMs ),\n\t\t[ analyze, debounceTimeInMs ],\n\t);\n\n\tuseEffectWithDeepCompare( () => {\n\t\tdebouncedAnalyze();\n\t}, [ debouncedAnalyze, paper, keyphrases, config, editor ] );\n};\n"],"file":"hooks.js"}