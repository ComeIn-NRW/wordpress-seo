{"version":3,"sources":["../../src/analysis/analysis.js"],"names":["applyFilters","__","isObject","omit","AnalysisWorkerWrapper","createWorker","createAnalyzeFunction","createAnalysisWorkerWrapper","workerUrl","dependencies","worker","postMessage","createAnalysisConfiguration","configuration","config","isContentAnalysisActive","isReadabilityActive","isKeywordAnalysisActive","isSeoActive","processedConfig","createAnalysis","initialize","e","console","error","analysisWorker","analyze"],"mappings":"AAAA,SAASA,YAAT,QAA6B,kBAA7B;AACA,SAASC,EAAT,QAAmB,iBAAnB;AACA,SAASC,QAAT,EAAmBC,IAAnB,QAA+B,QAA/B;AACA,SAASC,qBAAT,EAAgCC,YAAhC,QAAoD,UAApD;AAEA,OAAOC,qBAAP,MAAkC,WAAlC;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAMC,2BAA2B,GAAG,QAAmC;AAAA,MAAjC;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,GAAiC;AACtE,QAAMC,MAAM,GAAGL,YAAY,CAAEG,SAAF,CAA3B;AAEAE,EAAAA,MAAM,CAACC,WAAP,CAAoB;AAAEF,IAAAA,YAAY,EAAEA;AAAhB,GAApB;AAEA,SAAO,IAAIL,qBAAJ,CAA2BM,MAA3B,CAAP;AACA,CAND;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAME,2BAA2B,GAAG,YAA0B;AAAA,MAAxBC,aAAwB,uEAAR,EAAQ;AAC7D,QAAMC,MAAM,GAAG,EACd,GAAGX,IAAI,CAAEU,aAAF,EAAiB,CAAE,qBAAF,EAAyB,aAAzB,CAAjB,CADO;AAEdE,IAAAA,uBAAuB,EAAEF,aAAa,CAACG,mBAFzB;AAGdC,IAAAA,uBAAuB,EAAEJ,aAAa,CAACK;AAHzB,GAAf;AAMA,QAAMC,eAAe,GAAGnB,YAAY,CAAE,6CAAF,EAAiDc,MAAjD,CAApC;AAEA,SAAOZ,QAAQ,CAAEiB,eAAF,CAAR,GAA8BA,eAA9B,GAAgDL,MAAvD;AACA,CAVD;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAMM,cAAc,GAAG,eAA6D;AAAA,MAArD;AAAEZ,IAAAA,SAAF;AAAaC,IAAAA,YAAb;AAA2BI,IAAAA,aAAa,GAAG;AAA3C,GAAqD;AACnF,QAAMH,MAAM,GAAGH,2BAA2B,CAAE;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,GAAF,CAA1C;;AAEA,MAAI;AACH,UAAMC,MAAM,CAACW,UAAP,CAAmBT,2BAA2B,CAAEC,aAAF,CAA9C,CAAN;AACA,GAFD,CAEE,OAAQS,CAAR,EAAY;AACbC,IAAAA,OAAO,CAACC,KAAR,CACCvB,EAAE,CAAE,uFAAF,EAA2F,eAA3F,CADH,EAECqB,CAFD;AAIA;;AAED,SAAO;AACNG,IAAAA,cAAc,EAAEf,MADV;AAENgB,IAAAA,OAAO,EAAEpB,qBAAqB,CAAEI,MAAF,EAAUG,aAAV;AAFxB,GAAP;AAIA,CAhBD;;AAkBA,eAAeO,cAAf","sourcesContent":["import { applyFilters } from \"@wordpress/hooks\";\nimport { __ } from \"@wordpress/i18n\";\nimport { isObject, omit } from \"lodash\";\nimport { AnalysisWorkerWrapper, createWorker } from \"yoastseo\";\n\nimport createAnalyzeFunction from \"./analyze\";\n\n/**\n * Creates the analysis worker.\n *\n * @param {string} workerUrl The URL of the analysis worker.\n * @param {string[]} dependencies The dependencies to load within the worker.\n *\n * @returns {AnalysisWorkerWrapper} The analysis worker wrapper.\n */\nconst createAnalysisWorkerWrapper = ( { workerUrl, dependencies } ) => {\n\tconst worker = createWorker( workerUrl );\n\n\tworker.postMessage( { dependencies: dependencies } );\n\n\treturn new AnalysisWorkerWrapper( worker );\n};\n\n/**\n * Creates the analysis configuration.\n *\n * @param {Object} configuration The base configuration of the analysis worker.\n *\n * @returns {Object} The analysis configuration.\n */\nconst createAnalysisConfiguration = ( configuration = {} ) => {\n\tconst config = {\n\t\t...omit( configuration, [ \"isReadabilityActive\", \"isSeoActive\" ] ),\n\t\tisContentAnalysisActive: configuration.isReadabilityActive,\n\t\tisKeywordAnalysisActive: configuration.isSeoActive,\n\t};\n\n\tconst processedConfig = applyFilters( \"yoast.seoIntegration.analysis.configuration\", config );\n\n\treturn isObject( processedConfig ) ? processedConfig : config;\n};\n\n/**\n * Creates the analysis worker.\n *\n * @param {string} workerUrl The URL of the analysis worker.\n * @param {string[]} dependencies The dependencies to load in the worker.\n * @param {Object} configuration The base configuration of the analysis worker.\n *\n * @returns {{ analysisWorker: Object, analyze: Function }} The analysis worker and analyze function.\n */\nconst createAnalysis = async ( { workerUrl, dependencies, configuration = {} } ) => {\n\tconst worker = createAnalysisWorkerWrapper( { workerUrl, dependencies } );\n\n\ttry {\n\t\tawait worker.initialize( createAnalysisConfiguration( configuration ) );\n\t} catch ( e ) {\n\t\tconsole.error(\n\t\t\t__( \"Something went wrong with loading the analysis, please refresh the page to try again.\", \"wordpress-seo\" ),\n\t\t\te,\n\t\t);\n\t}\n\n\treturn {\n\t\tanalysisWorker: worker,\n\t\tanalyze: createAnalyzeFunction( worker, configuration ),\n\t};\n};\n\nexport default createAnalysis;\n"],"file":"analysis.js"}