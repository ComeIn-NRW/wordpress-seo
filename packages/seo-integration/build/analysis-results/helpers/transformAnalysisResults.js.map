{"version":3,"sources":["../../../src/analysis-results/helpers/transformAnalysisResults.js"],"names":["reduce","interpreters","transformAnalysisResult","result","idPrefix","rating","scoreToRating","score","id","identifier","length","markerId","text","hasMarks","marks","marker","transformAnalysisResults","results","grouped","transformed","errorsResults","push","considerationsResults","problemsResults","improvementsResults","goodResults"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SAASA,MAAT,QAAuB,QAAvB;AACA,SAASC,YAAT,QAA6B,UAA7B;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAMC,uBAAuB,GAAG,UAAEC,MAAF,EAA6B;AAAA,MAAnBC,QAAmB,uEAAR,EAAQ;AAC5D,QAAMC,MAAM,GAAGJ,YAAY,CAACK,aAAb,CAA4BH,MAAM,CAACI,KAAnC,CAAf;AACA,MAAIC,EAAE,GAAGL,MAAM,CAACM,UAAhB;;AAEA,MAAKL,QAAQ,CAACM,MAAT,GAAkB,CAAvB,EAA2B;AAC1BF,IAAAA,EAAE,GAAI,GAAGJ,QAAU,IAAII,EAAI,EAA3B;AACA;;AAED,SAAO;AACNA,IAAAA,EADM;AAENG,IAAAA,QAAQ,EAAEH,EAFJ;AAGNI,IAAAA,IAAI,EAAET,MAAM,CAACS,IAHP;AAINL,IAAAA,KAAK,EAAEJ,MAAM,CAACI,KAJR;AAKN;AACAF,IAAAA,MAAM,EAAEA,MAAM,KAAK,IAAX,GAAkB,IAAlB,GAAyBA,MAN3B;AAONQ,IAAAA,QAAQ,EAAEV,MAAM,CAACW,KAAP,CAAaJ,MAAb,GAAsB,CAP1B;;AAQN;AACF;AACA;AACA;AACEK,IAAAA,MAAM,EAAEZ,MAAM,CAACW;AAZT,GAAP;AAcA,CAtBD;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,OAAO,MAAME,wBAAwB,GAAG;AAAA,MAAEC,OAAF,uEAAY,EAAZ;AAAA,MAAgBb,QAAhB,uEAA2B,EAA3B;AAAA,SAAmCJ,MAAM,CAChFiB,OADgF,EAEhF,CAAEC,OAAF,EAAWf,MAAX,KAAuB;AACtB,UAAMgB,WAAW,GAAGjB,uBAAuB,CAAEC,MAAF,EAAUC,QAAV,CAA3C,CADsB,CAGtB;;AACA,QAAKe,WAAW,CAACP,IAAZ,KAAqB,EAA1B,EAA+B;AAC9B,aAAOM,OAAP;AACA;;AAED,YAASC,WAAW,CAACd,MAArB;AACC,WAAK,OAAL;AACCa,QAAAA,OAAO,CAACE,aAAR,CAAsBC,IAAtB,CAA4BF,WAA5B;AACA;;AACD,WAAK,UAAL;AACCD,QAAAA,OAAO,CAACI,qBAAR,CAA8BD,IAA9B,CAAoCF,WAApC;AACA;;AACD,WAAK,KAAL;AACCD,QAAAA,OAAO,CAACK,eAAR,CAAwBF,IAAxB,CAA8BF,WAA9B;AACA;;AACD,WAAK,IAAL;AACA,WAAK,IAAL;AACCD,QAAAA,OAAO,CAACM,mBAAR,CAA4BH,IAA5B,CAAkCF,WAAlC;AACA;;AACD,WAAK,MAAL;AACCD,QAAAA,OAAO,CAACO,WAAR,CAAoBJ,IAApB,CAA0BF,WAA1B;AACA;AAhBF;;AAmBA,WAAOD,OAAP;AACA,GA9B+E,EA+BhF;AACCE,IAAAA,aAAa,EAAE,EADhB;AAECG,IAAAA,eAAe,EAAE,EAFlB;AAGCC,IAAAA,mBAAmB,EAAE,EAHtB;AAICC,IAAAA,WAAW,EAAE,EAJd;AAKCH,IAAAA,qBAAqB,EAAE;AALxB,GA/BgF,CAAzC;AAAA,CAAjC","sourcesContent":["/**\n * @typedef {Object} AnalysisReportResult\n *\n * @property {number} score The score as a number.\n * @property {string} rating The rating, which is the interpreted score.\n * @property {string} text The feedback string.\n * @property {string} id Unique ID. Used in the mark button as ID and passed to the callback.\n * @property {Mark[]} marker The marks. Used as argument in the mark callback.\n * @property {string} markerId Should be the same as the ID, used to check if a mark button is pressed.\n * @property {bool} hasMarks Whether the result has something to mark.\n */\n\n/**\n * @typedef {Object} AnalysisReportResults\n *\n * @property {AnalysisReportResult[]} errorsResults The error results.\n * @property {AnalysisReportResult[]} problemsResults The problem results.\n * @property {AnalysisReportResult[]} improvementsResults The improvement results.\n * @property {AnalysisReportResult[]} goodResults The good results.\n * @property {AnalysisReportResult[]} considerationsResults The consideration results.\n */\n\nimport { reduce } from \"lodash\";\nimport { interpreters } from \"yoastseo\";\n\n/**\n * Maps an AssessmentResult to an analysis report result.\n *\n * So that it can be used by @yoast/analysis-report's ContentAnalysis.\n *\n * @param {Object} result Result provided by the analysis worker.\n * @param {string} idPrefix Prefix the ID with this, useful to namespace the results.\n *\n * @returns {AnalysisReportResult} The analysis report result.\n */\nconst transformAnalysisResult = ( result, idPrefix = \"\" ) => {\n\tconst rating = interpreters.scoreToRating( result.score );\n\tlet id = result.identifier;\n\n\tif ( idPrefix.length > 0 ) {\n\t\tid = `${ idPrefix }:${ id }`;\n\t}\n\n\treturn {\n\t\tid,\n\t\tmarkerId: id,\n\t\ttext: result.text,\n\t\tscore: result.score,\n\t\t// Because of inconsistency between `yoastseo` and `@yoast/analysis-report`.\n\t\trating: rating === \"ok\" ? \"OK\" : rating,\n\t\thasMarks: result.marks.length > 0,\n\t\t/*\n\t\t * Returning the marks instead of the marker to decouple the marker from the results. Leaving the marking to the UI.\n\t\t * This is done here to be able to leave the AnalysisList package alone, where the `marker` is the attribute passed to the button callback.\n\t\t */\n\t\tmarker: result.marks,\n\t};\n};\n\n/**\n * Transforms the analysis results, while grouping them by rating.\n *\n * @param {AssessmentResult[]} results The assessment results, as returned by the analysis.\n * @param {string} [idPrefix] Prefix the ID with this, useful to namespace the results.\n *\n * @returns {Object.<string, AnalysisReportResults[]>} The assessment results, grouped by rating.\n */\nexport const transformAnalysisResults = ( results = [], idPrefix = \"\" ) => reduce(\n\tresults,\n\t( grouped, result ) => {\n\t\tconst transformed = transformAnalysisResult( result, idPrefix );\n\n\t\t// Filter out empty results.\n\t\tif ( transformed.text === \"\" ) {\n\t\t\treturn grouped;\n\t\t}\n\n\t\tswitch ( transformed.rating ) {\n\t\t\tcase \"error\":\n\t\t\t\tgrouped.errorsResults.push( transformed );\n\t\t\t\tbreak;\n\t\t\tcase \"feedback\":\n\t\t\t\tgrouped.considerationsResults.push( transformed );\n\t\t\t\tbreak;\n\t\t\tcase \"bad\":\n\t\t\t\tgrouped.problemsResults.push( transformed );\n\t\t\t\tbreak;\n\t\t\tcase \"ok\":\n\t\t\tcase \"OK\":\n\t\t\t\tgrouped.improvementsResults.push( transformed );\n\t\t\t\tbreak;\n\t\t\tcase \"good\":\n\t\t\t\tgrouped.goodResults.push( transformed );\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn grouped;\n\t},\n\t{\n\t\terrorsResults: [],\n\t\tproblemsResults: [],\n\t\timprovementsResults: [],\n\t\tgoodResults: [],\n\t\tconsiderationsResults: [],\n\t},\n);\n"],"file":"transformAnalysisResults.js"}